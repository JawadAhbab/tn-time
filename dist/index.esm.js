import{numpad as e}from"tn-numpad";import{isArray as t}from"tn-validate";const s="d|D|m|M|y|Y|h|H|i|s|S|a|A".split("|"),n="d|D|m|M|h|H|i|s|S".split("|"),r=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];let s="am";return e.getHours()>=12&&(s="pm"),t&&(s=s.toUpperCase()),s},i=function(t,s){let n,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(n="date"===s?t.getDate():"min"===s?t.getMinutes():"sec"===s?t.getSeconds():t.getMilliseconds(),r){n=e(n,"ms"===s?3:2)}return n},o="Sun|Mon|Tue|Wed|Thu|Fri|Sat".split("|"),a="Sunday|Monday|Tuesday|Wednesday|Thursday|Friday|Saturday".split("|"),u=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const s=e.getDay();return t?a[s]:o[s]},c=(t,s,n)=>{let r=t.getHours();return s||(r>12&&(r-=12),0===r&&(r=12)),n&&(r=e(r,2)),r},l="Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec".split("|"),m="January|February|March|April|May|June|July|August|September|October|November|December".split("|"),d=(t,s,n)=>{let r=t.getMonth();return s?n?m[r]:l[r]:(++r,n?e(r,2):r)},h=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=e.getFullYear();return t||(s=s.toString().substr(2,2)),s},y=e=>({d:()=>i(e,"date"),dd:()=>i(e,"date",!0),D:()=>u(e),DD:()=>u(e,!0),m:()=>d(e,!1,!1),mm:()=>d(e,!1,!0),M:()=>d(e,!0,!1),MM:()=>d(e,!0,!0),y:()=>h(e),Y:()=>h(e,!0),h:()=>c(e,!1,!1),hh:()=>c(e,!1,!0),H:()=>c(e,!0,!1),HH:()=>c(e,!0,!0),i:()=>i(e,"min"),ii:()=>i(e,"min",!0),s:()=>i(e,"sec"),ss:()=>i(e,"sec",!0),S:()=>i(e,"ms"),SS:()=>i(e,"ms",!0),a:()=>r(e),A:()=>r(e,!0)}),g=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{zone:i}=r;let o=e;i&&(o=new Date(new Date(e).toLocaleString("en-US",{timeZone:i,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})));return((e,t)=>{let s="";const n=y(e);return t.forEach((e=>{if(!e.iskey)return s+=e.char;s+=n[e.char]().toString()})),s})(o,(e=>{const t=[];let r=!1,i="",o=!1;return e.split("").forEach((e=>{if("{"!==e){if("}"===e)return t.push({iskey:!1,char:i}),i="",void(r=!1);if(r)i+=e;else{if(o)s.includes(e)&&e===o?t.push({iskey:!0,char:e+e}):s.includes(e)?(t.push({iskey:!0,char:o}),t.push({iskey:!0,char:e})):(t.push({iskey:!0,char:o}),t.push({iskey:!1,char:e}));else{if(n.includes(e))return void(o=e);s.includes(e)?t.push({iskey:!0,char:e}):t.push({iskey:!1,char:e})}o=!1}}else r=!0})),o&&t.push({iskey:!0,char:o}),t})(t??"dd-mm-Y"))},p=e=>e.getTime()>(new Date).getTime(),f=e=>e.getTime()<(new Date).getTime(),D=36e5,M=24*D,b={msec:1,yr:365*M,sec:1e3,min:6e4,hr:D,day:M,mo:30*M},v=(e,t)=>({clause:t,number:e/b[t]}),S=function(e,t,s){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],r=arguments.length>4?arguments[4]:void 0;const i=t[t.length-1]??"yr";let o;if(r)o=v(e,r);else for(const s of t)if(!(e<b[s]&&i!==s)){o=v(e,s);break}if(n.length+1>=s)return n.push(o),n;{const e=t[t.findIndex((e=>e===o.clause))+1];if(e){const r=Math.floor(o.number),i=Math.round(b[o.clause]*(o.number-r));return o.number=r,n.push(o),S(i,t,s,n,e)}return n.push(o),n}},T=e=>{const s=k[e.variant];return Object.entries(e.formats).forEach((e=>{let[n,r]=e;const i=r;s[n]=t(i)?i:[i,i]})),s},k={minimal:{yr:["y","y"],mo:["mo","mo"],day:["d","d"],hr:["h","h"],min:["m","m"],sec:["s","s"],msec:["ms","ms"]},short:{yr:[" yr"," yrs"],mo:[" mo"," mos"],day:[" day"," days"],hr:[" hr"," hrs"],min:[" min"," mins"],sec:[" sec"," secs"],msec:[" msec"," msecs"]},verbose:{yr:[" year"," years"],mo:[" month"," months"],day:[" day"," days"],hr:[" hour"," hours"],min:[" minute"," minutes"],sec:[" second"," seconds"],msec:[" millisecond"," milliseconds"]},bangla:{yr:[" বছর"," বছর"],mo:[" মাস"," মাস"],day:[" দিন"," দিন"],hr:[" ঘণ্টা"," ঘণ্টা"],min:[" মিনিট"," মিনিট"],sec:[" সেকেন্ড"," সেকেন্ড"],msec:[" মিলিসেকেন্ড"," মিলিসেকেন্ড"]}},w=(e,t,s)=>b[e]>=b[s],A={decimal:0,maxClause:1,clauseJoin:" ",lastBlankClause:!1,trimBlankClause:!1,variant:"verbose",formats:{},prefix:"",postfix:"",clauses:["yr","day","hr","min","sec"]};function x(e,t,s){const{gapms:n,opts:r}=((e,t)=>{const s=Math.abs((new Date).getTime()-e.getTime()),n={...A,...t||{}};return n.clauses=(e=>{const t=[];return e.includes("yr")&&t.push("yr"),e.includes("mo")&&t.push("mo"),e.includes("day")&&t.push("day"),e.includes("hr")&&t.push("hr"),e.includes("min")&&t.push("min"),e.includes("sec")&&t.push("sec"),e.includes("msec")&&t.push("msec"),t})(n.clauses),{gapms:s,opts:n}})(t,s);let i=n;("AGO"===e&&p(t)||"REMAIN"===e&&f(t))&&(i=0);const o=((e,t)=>{const{decimal:s}=t;console.log(e);let n=e;const r=n[n.length-1];return r.number=parseFloat(r.number.toFixed(s)),function(){if(n.length<=1)return;const e=n[n.length-1];console.log(e)}(),console.log(n),n})(S(i,r.clauses,r.maxClause),r);return((e,t)=>{const{prefix:s,clauseJoin:n,postfix:r}=t,i=T(t);return`${s}${e.map((e=>{let{number:t,clause:s}=e;return`${t}${i[s][t<=1?0:1]}`})).join(n)}${r}`})(o,r)}const F=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"day";const s=new Date(e);return w(t,0,"yr")&&s.setMonth(0),w(t,0,"mo")&&s.setDate(1),w(t,0,"day")&&s.setHours(0),w(t,0,"hr")&&s.setMinutes(0),w(t,0,"min")&&s.setSeconds(0),s.setMilliseconds(0),new Date(s)},H=e=>{let t=e?new Date(e):new Date;return isNaN(t.getTime())&&(t=new Date),{getDate:()=>t,format:(e,s)=>g(t,e,s),gap:e=>x("GAP",t,e),ago:e=>x("AGO",t,e),remain:e=>x("REMAIN",t,e),shift:(e,s)=>function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"day";const n=e.getTime()+t*b[s];return new Date(n)}(t,e,s),round:e=>F(t,e),isToday:()=>(e=>F(e).getTime()===F(new Date).getTime())(t),isPast:()=>f(t),isFuture:()=>p(t)}};export{H as time};
