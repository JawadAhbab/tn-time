import"tn-consoler";import{isArray as e}from"tn-validate";import{numpad as s}from"tn-numpad";const t={minimal:{yr:["y","y"],mo:["mo","mo"],day:["d","d"],hr:["h","h"],min:["m","m"],sec:["s","s"],msec:["ms","ms"]},short:{yr:[" yr"," yrs"],mo:[" mo"," mos"],day:[" day"," days"],hr:[" hr"," hrs"],min:[" min"," mins"],sec:[" sec"," secs"],msec:[" msec"," msecs"]},verbose:{yr:[" year"," years"],mo:[" month"," months"],day:[" day"," days"],hr:[" hour"," hours"],min:[" minute"," minutes"],sec:[" second"," seconds"],msec:[" millisecond"," milliseconds"]}},r=864e5,n={msec:1,yr:31536e6,sec:1e3,min:6e4,hr:36e5,day:r,mo:2592e6},i={decimal:0,variant:"verbose",formats:{},prefix:"",postfix:"",yr:!0,mo:!1,day:!0,hr:!0,min:!0,sec:!0,msec:!1};function m(s,r){const{agoms:m,opts:o}=((e,s)=>{const t=(new Date).getTime()-e.getTime();return{agoms:t<0?0:t,opts:{...i,...s||{}}}})(s,r),a=(s=>{const r=t[s.variant];return Object.entries(s.formats).forEach((([s,t])=>{const n=t;r[s]=e(n)?n:[n,n]})),(e,t,n)=>{const i=parseFloat(e.toFixed(t));return`${s.prefix}${i}${r[n][i<=1?0:1]}${s.postfix}`}})(o),{key:c,number:u}=((e,s)=>{const{yr:t,mo:r,day:i,hr:m,min:o,sec:a,msec:c}=s;let u="yr";return r&&(u="mo"),i&&(u="day"),m&&(u="hr"),o&&(u="min"),a&&(u="sec"),c&&(u="msec"),e>=n.yr&&t||"yr"===u?{number:e/n.yr,key:"yr"}:e>=n.mo&&r||"mo"===u?{number:e/n.mo,key:"mo"}:e>=n.day&&i||"day"===u?{number:e/n.day,key:"day"}:e>=n.hr&&m||"hr"===u?{number:e/n.hr,key:"hr"}:e>=n.min&&o||"min"===u?{number:e/n.min,key:"min"}:e>=n.sec&&a||"sec"===u?{number:e/n.sec,key:"sec"}:{number:e,key:"msec"}})(m,o);return a(u,o.decimal,c)}const o="d|D|m|M|y|Y|h|H|i|s|S|a|A".split("|"),a="d|D|m|M|h|H|i|s|S".split("|");function c(e,s=!1){let t="am";return e.getHours()>=12&&(t="pm"),s&&(t=t.toUpperCase()),t}function u(e,t,r=!1){let n;if(n="date"===t?e.getDate():"min"===t?e.getMinutes():"sec"===t?e.getSeconds():e.getMilliseconds(),r){n=s(n,"ms"===t?3:2)}return n}const y="Sun|Mon|Tue|Wed|Thu|Fri|Sat".split("|"),d="Sunday|Monday|Tuesday|Wednesday|Thursday|Friday|Saturday".split("|");function h(e,s=!1){const t=e.getDay();return s?d[t]:y[t]}function l(e,t,r){let n=e.getHours();return t||(n>12&&(n-=12),0===n&&(n=12)),r&&(n=s(n,2)),n}const p="Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec".split("|"),f="January|February|March|April|May|June|July|August|September|October|November|December".split("|");function g(e,t,r){let n=e.getMonth();return t?r?f[n]:p[n]:(++n,r?s(n,2):n)}function D(e,s=!1){let t=e.getFullYear();return s||(t=t.toString().substr(2,2)),t}function b(e,s){let t="";const r=function(e){return{d:()=>u(e,"date"),dd:()=>u(e,"date",!0),D:()=>h(e),DD:()=>h(e,!0),m:()=>g(e,!1,!1),mm:()=>g(e,!1,!0),M:()=>g(e,!0,!1),MM:()=>g(e,!0,!0),y:()=>D(e),Y:()=>D(e,!0),h:()=>l(e,!1,!1),hh:()=>l(e,!1,!0),H:()=>l(e,!0,!1),HH:()=>l(e,!0,!0),i:()=>u(e,"min"),ii:()=>u(e,"min",!0),s:()=>u(e,"sec"),ss:()=>u(e,"sec",!0),S:()=>u(e,"ms"),SS:()=>u(e,"ms",!0),a:()=>c(e),A:()=>c(e,!0)}}(e);return s.forEach((e=>{e.iskey?t+=r[e.char]().toString():t+=e.char})),t}const k=(e,s="dd-mm-Y")=>b(e,function(e){const s=[];let t=!1,r="",n=!1;return e.split("").forEach((e=>{if("{"!==e){if("}"===e)return s.push({iskey:!1,char:r}),r="",void(t=!1);if(t)r+=e;else{if(n)o.includes(e)&&e===n?s.push({iskey:!0,char:e+e}):o.includes(e)?(s.push({iskey:!0,char:n}),s.push({iskey:!0,char:e})):(s.push({iskey:!0,char:n}),s.push({iskey:!1,char:e}));else{if(a.includes(e))return void(n=e);o.includes(e)?s.push({iskey:!0,char:e}):s.push({iskey:!1,char:e})}n=!1}}else t=!0})),n&&s.push({iskey:!0,char:n}),s}(s)),M=e=>{let s=e?new Date(e):new Date;return isNaN(s.getTime())&&(s=new Date),{getDate:()=>s,format:e=>k(s,e),ago:e=>m(s,e),shift:(e,t)=>((e,s,t="day")=>{const r=e.getTime()+s*n[t];return new Date(r)})(s,e,t),round:()=>(e=>{const s=new Date(e);return new Date(s.setHours(0,0,0,0))})(s),isToday:()=>(e=>{const s=new Date(e),t=new Date;return s.setHours(0,0,0,0)===t.setHours(0,0,0,0)})(s),isPast:()=>(e=>e.getTime()<(new Date).getTime())(s),isFuture:()=>(e=>e.getTime()>(new Date).getTime())(s)}};export{M as time};
